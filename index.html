<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sambhaji | AI Logistics Platform for Smarter Delivery</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: #333;
            overflow-x: hidden;
        }

        /* Marketing Site Styles */
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .navbar {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            padding: 1rem 0;
            transition: all 0.3s ease;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(20px);
        }

        .navbar.scrolled {
            background: rgba(15, 23, 42, 0.95);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            cursor: pointer;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-menu a {
            color: #e2e8f0;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
        }

        .nav-menu a:hover {
            color: #667eea;
            transform: translateY(-2px);
        }

        .cta-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .hero {
            min-height: 100vh;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .hero-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .hero-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
            z-index: 2;
            position: relative;
        }

        .hero-text {
            color: white;
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            line-height: 1.2;
        }

        .hero-title .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero-subtitle {
            font-size: 1.25rem;
            margin-bottom: 2rem;
            color: #cbd5e1;
            line-height: 1.6;
        }

        .hero-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 3rem;
        }

        .btn-secondary {
            background: transparent;
            color: white;
            border: 2px solid #667eea;
            padding: 0.75rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-secondary:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
            display: block;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .hero-visual {
            position: relative;
            height: 500px;
        }

        .features {
            padding: 8rem 0;
            background: #f8fafc;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: #1e293b;
        }

        .section-subtitle {
            text-align: center;
            font-size: 1.1rem;
            color: #64748b;
            margin-bottom: 4rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 3rem;
        }

        .feature-card {
            background: white;
            padding: 3rem;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            color: white;
        }

        .feature-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #1e293b;
        }

        .feature-description {
            color: #64748b;
            line-height: 1.6;
        }

        .how-it-works {
            padding: 8rem 0;
            background: #0f172a;
            color: white;
        }

        .steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-top: 4rem;
        }

        .step {
            text-align: center;
            position: relative;
        }

        .step-number {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0 auto 1.5rem;
            color: white;
        }

        .step-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .step-description {
            color: #cbd5e1;
            line-height: 1.6;
        }

        .cta-section {
            padding: 6rem 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            text-align: center;
            color: white;
        }

        .cta-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .cta-subtitle {
            font-size: 1.1rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .cta-button-white {
            background: white;
            color: #667eea;
            padding: 1rem 3rem;
            border: none;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .cta-button-white:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 255, 255, 0.3);
        }

        .footer {
            background: #0f172a;
            color: white;
            padding: 3rem 0 2rem;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .footer-section h3 {
            margin-bottom: 1rem;
            color: #667eea;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 0.5rem;
        }

        .footer-section ul li a {
            color: #cbd5e1;
            text-decoration: none;
            transition: color 0.3s ease;
            cursor: pointer;
        }

        .footer-section ul li a:hover {
            color: #667eea;
        }

        .footer-bottom {
            border-top: 1px solid #334155;
            margin-top: 2rem;
            padding-top: 2rem;
            text-align: center;
            color: #94a3b8;
        }

        /* Demo App Styles */
        .app-container {
            display: none;
            min-height: 100vh;
            background: linear-gradient(180deg, #071029 0%, #061027 100%);
            color: #e6eef8;
            font-family: 'Inter', ui-sans-serif, system-ui, Arial;
        }

        .app-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 20px;
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.02), transparent);
            backdrop-filter: blur(6px);
        }

        .app-header h1 {
            font-size: 18px;
            margin: 0;
        }

        .app-header .user {
            font-size: 13px;
            color: #94a3b8;
        }

        .app-main {
            display: grid;
            grid-template-columns: 260px 1fr;
            gap: 18px;
            padding: 18px;
        }

        .app-nav {
            background: #0b1220;
            padding: 14px;
            border-radius: 12px;
            height: calc(100vh - 110px);
            overflow: auto;
        }

        .app-nav button {
            display: block;
            width: 100%;
            text-align: left;
            padding: 10px;
            border-radius: 8px;
            border: none;
            background: transparent;
            color: #dbeafe;
            margin-bottom: 6px;
            cursor: pointer;
        }

        .app-nav button.active {
            background: linear-gradient(90deg, #06b6d4, #7c3aed);
            color: #021026;
        }

        .app-content {
            padding: 14px;
        }

        .app-card {
            background: #0b1220;
            padding: 14px;
            border-radius: 12px;
            margin-bottom: 12px;
        }

        .app-grid-2 {
            display: grid;
            grid-template-columns: 1fr 420px;
            gap: 12px;
        }

        .app-table {
            width: 100%;
            border-collapse: collapse;
        }

        .app-table th, .app-table td {
            padding: 8px;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.03);
            font-size: 13px;
        }

        .app-muted {
            color: #94a3b8;
        }

        .app-btn {
            padding: 8px 10px;
            border-radius: 8px;
            border: none;
            background: #06b6d4;
            color: #022;
            cursor: pointer;
        }

        .app-btn.secondary {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.06);
            color: #94a3b8;
        }

        .app-input, .app-select, .app-textarea {
            width: 100%;
            padding: 8px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.06);
            background: transparent;
            color: inherit;
        }

        .app-small {
            font-size: 13px;
        }

        .app-flex {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .app-right {
            justify-content: flex-end;
        }

        .role-badge {
            padding: 6px 8px;
            border-radius: 999px;
            background: rgba(255, 255, 255, 0.03);
            font-size: 12px;
        }

        .back-to-site {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 20px;
            transition: all 0.3s ease;
        }

        .back-to-site:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Page visibility */
        .page-section {
            display: none;
        }

        .page-section.active {
            display: block;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-content {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .hero-title {
                font-size: 2.5rem;
            }

            .nav-menu {
                display: none;
            }

            .stats {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }

            .app-main {
                grid-template-columns: 1fr;
            }

            .app-nav {
                height: auto;
                order: 2;
            }

            .app-grid-2 {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        .floating {
            animation: float 6s ease-in-out infinite;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.8s ease;
        }
    </style>
</head>
<body>
    <!-- Marketing Site -->
    <div id="marketing-site">
        <!-- Navigation -->
        <nav class="navbar" id="navbar">
            <div class="nav-container">
                <div class="logo" onclick="showSection('home')">Sambhaji</div>
                <ul class="nav-menu">
                    <li><a onclick="showSection('features')">Features</a></li>
                    <li><a onclick="showSection('how-it-works')">How It Works</a></li>
                    <li><a onclick="showSection('demo')">Live Demo</a></li>
                    <li><a onclick="showSection('contact')">Contact</a></li>
                </ul>
                <a onclick="showDemo()" class="cta-button">Try Demo</a>
            </div>
        </nav>

        <!-- Home Section -->
        <section id="home-section" class="page-section active">
            <div class="hero">
                <div class="hero-bg" id="hero-bg"></div>
                <div class="hero-content">
                    <div class="hero-text fade-in-up">
                        <h1 class="hero-title">
                            <span class="gradient-text">AI-Powered</span><br>
                            Logistics Revolution
                        </h1>
                        <p class="hero-subtitle">
                            Transform your delivery operations with intelligent route optimization, 
                            real-time tracking, and predictive analytics. Experience up to 40% cost reduction 
                            and 99% on-time delivery rates.
                        </p>
                        <div class="hero-buttons">
                            <a onclick="showDemo()" class="cta-button">Try Live Demo</a>
                            <a onclick="showSection('features')" class="btn-secondary">Learn More</a>
                        </div>
                        <div class="stats">
                            <div class="stat">
                                <span class="stat-number">40%</span>
                                <span class="stat-label">Cost Reduction</span>
                            </div>
                            <div class="stat">
                                <span class="stat-number">99%</span>
                                <span class="stat-label">On-Time Delivery</span>
                            </div>
                            <div class="stat">
                                <span class="stat-number">500+</span>
                                <span class="stat-label">Companies Trust Us</span>
                            </div>
                        </div>
                    </div>
                    <div class="hero-visual">
                        <div class="floating" id="floating-visual"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section id="features-section" class="page-section">
            <div class="features">
                <div class="container">
                    <h2 class="section-title">Intelligent Features</h2>
                    <p class="section-subtitle">
                        Powered by advanced AI and machine learning algorithms to optimize every aspect of your logistics operations
                    </p>
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">🤖</div>
                            <h3 class="feature-title">AI Route Optimization</h3>
                            <p class="feature-description">
                                Advanced algorithms analyze traffic patterns, weather conditions, and delivery windows to create the most efficient routes, reducing fuel costs by up to 35%.
                            </p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">📍</div>
                            <h3 class="feature-title">Real-Time Tracking</h3>
                            <p class="feature-description">
                                Live GPS tracking with predictive ETAs, automated customer notifications, and comprehensive visibility across your entire fleet operations.
                            </p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">📊</div>
                            <h3 class="feature-title">Predictive Analytics</h3>
                            <p class="feature-description">
                                Machine learning models predict demand patterns, identify potential delays, and suggest proactive adjustments to maintain service excellence.
                            </p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">⚡</div>
                            <h3 class="feature-title">Dynamic Dispatch</h3>
                            <p class="feature-description">
                                Intelligent job assignment based on driver location, skills, vehicle capacity, and real-time conditions for maximum efficiency.
                            </p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🔗</div>
                            <h3 class="feature-title">Seamless Integration</h3>
                            <p class="feature-description">
                                Connect with existing ERP, WMS, and e-commerce platforms through robust APIs and pre-built integrations.
                            </p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">📱</div>
                            <h3 class="feature-title">Mobile Excellence</h3>
                            <p class="feature-description">
                                Native mobile apps for drivers and customers with offline capability, digital proof of delivery, and instant communication.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- How It Works Section -->
        <section id="how-it-works-section" class="page-section">
            <div class="how-it-works">
                <div class="container">
                    <h2 class="section-title" style="color: white;">How Sambhaji Works</h2>
                    <p class="section-subtitle" style="color: #cbd5e1;">
                        Get started in minutes with our simple three-step process
                    </p>
                    <div class="steps">
                        <div class="step">
                            <div class="step-number">1</div>
                            <h3 class="step-title">Connect Your Systems</h3>
                            <p class="step-description">
                                Integrate Sambhaji with your existing platforms using our API or pre-built connectors. Setup takes just minutes.
                            </p>
                        </div>
                        <div class="step">
                            <div class="step-number">2</div>
                            <h3 class="step-title">AI Learns Your Business</h3>
                            <p class="step-description">
                                Our AI analyzes your historical data, delivery patterns, and operational constraints to create optimal strategies.
                            </p>
                        </div>
                        <div class="step">
                            <div class="step-number">3</div>
                            <h3 class="step-title">Watch Efficiency Soar</h3>
                            <p class="step-description">
                                Experience immediate improvements in delivery times, cost reduction, and customer satisfaction with real-time insights.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="cta-section">
            <div class="container">
                <h2 class="cta-title">Ready to Transform Your Logistics?</h2>
                <p class="cta-subtitle">Join 500+ companies already saving millions with Sambhaji AI</p>
                <a onclick="showDemo()" class="cta-button-white">Try Live Demo Now</a>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Sambhaji</h3>
                    <p style="color: #cbd5e1; line-height: 1.6;">
                        AI-powered logistics platform helping businesses deliver smarter, faster, and more efficiently.
                    </p>
                    <div style="margin-top: 1.5rem;">
                        <div style="margin-bottom: 0.5rem;"><strong style="color: #667eea;">Contact:</strong></div>
                        <div style="font-size: 0.9rem; color: #cbd5e1;">Sambhav Pachauri</div>
                        <div style="font-size: 0.9rem; color: #cbd5e1;">
                            <a href="mailto:Pachaurisambhav854@gmail.com" style="color: #94a3b8;">Pachaurisambhav854@gmail.com</a>
                        </div>
                        <div style="font-size: 0.9rem; color: #cbd5e1;">
                            <a href="tel:+919548597713" style="color: #94a3b8;">+91 9548597713</a>
                        </div>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Product</h3>
                    <ul>
                        <li><a onclick="showSection('features')">Features</a></li>
                        <li><a onclick="showDemo()">Live Demo</a></li>
                        <li><a>API Documentation</a></li>
                        <li><a>Integrations</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Company</h3>
                    <ul>
                        <li><a>About Us</a></li>
                        <li><a>Careers</a></li>
                        <li><a>Blog</a></li>
                        <li><a onclick="showSection('contact')">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Support</h3>
                    <ul>
                        <li><a>Help Center</a></li>
                        <li><a>Documentation</a></li>
                        <li><a>System Status</a></li>
                        <li><a>Security</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Sambhaji AI Logistics. All rights reserved.</p>
            </div>
        </footer>
    </div>

    <!-- Demo Application -->
    <div id="demo-app" class="app-container">
        <header class="app-header">
            <div>
                <button class="back-to-site" onclick="showSite()">← Back to Site</button>
                <span style="font-size: 18px; font-weight: 600;">Sambhaji AI Logistics — Live Demo</span>
                <div class="app-muted app-small" style="margin-top: 4px;">Interactive demo with built-in AI heuristics. Data stored locally.</div>
            </div>
            <div class="user app-small">Logged in as <span id="ui-username">Guest</span> • <span id="ui-role" class="role-badge">Viewer</span></div>
        </header>

        <div class="app-main">
            <nav class="app-nav">
                <button id="nav-dashboard" class="active">Dashboard</button>
                <button id="nav-shipments">Shipments</button>
                <button id="nav-vehicles">Vehicles</button>
                <button id="nav-routes">Route Planning</button>
                <button id="nav-analytics">Analytics</button>
                <button id="nav-ai">AI Optimizer</button>
                <button id="nav-notifications">Notifications</button>
                <button id="nav-import">Import / Export</button>
                <button id="nav-chat">AI Assistant</button>
                <hr style="margin: 10px 0; border: none; border-top: 1px solid rgba(255,255,255,0.1);">
                <div style="margin-top:10px">
                    <label class="app-small">Login as:</label>
                    <select id="login-role" class="app-small app-select" style="margin-top: 8px;">
                        <option value="admin">Admin</option>
                        <option value="dispatcher">Dispatcher</option>
                        <option value="driver">Driver</option>
                        <option value="viewer" selected>Viewer</option>
                    </select>
                    <input id="login-name" class="app-input" placeholder="Your name" style="margin-top:8px">
                    <div style="margin-top:8px" class="app-flex">
                        <button id="btn-login" class="app-btn">Login</button>
                        <button id="btn-reset" class="app-btn secondary">Reset Data</button>
                    </div>
                </div>
            </nav>

            <main class="app-content">
                <section id="page-dashboard" class="app-card"> 
                    <h2>Overview</h2>
                    <div class="app-grid-2" style="margin-top:12px">
                        <div>
                            <div class="app-card">
                                <h3>Key Metrics</h3>
                                <div class="app-flex" style="margin-top:8px">
                                    <div style="flex:1">
                                        <div class="app-muted app-small">Assigned</div>
                                        <div id="stat-assigned" style="font-size:18px">0</div>
                                    </div>
                                </div>
                            </div>

                            <div class="app-card">
                                <h3>Quick Actions</h3>
                                <div style="margin-top:8px" class="app-flex">
                                    <button id="quick-add-shipment" class="app-btn">Add Shipment</button>
                                    <button id="quick-add-vehicle" class="app-btn secondary">Add Vehicle</button>
                                    <button id="quick-optimize" class="app-btn">AI Optimize Routes</button>
                                </div>
                                <div style="margin-top:8px" class="app-muted app-small">Pro tip: provide lat/lon for accurate distance-based assignment. This demo uses Euclidean distances as approximation.</div>
                            </div>

                            <div class="app-card">
                                <h3>Assignments</h3>
                                <div id="assignments-list" class="app-small app-muted">No assignments yet.</div>
                            </div>
                        </div>

                        <div>
                            <div class="app-card">
                                <h3>Map (Simple Grid)</h3>
                                <div id="mini-map" style="height:320px;background:linear-gradient(180deg,#052032,#07223a);border-radius:8px;padding:8px;overflow:auto"></div>
                            </div>

                            <div class="app-card">
                                <h3>ETA Estimator</h3>
                                <div class="app-muted app-small">Select a vehicle and a shipment to estimate arrival time.</div>
                                <div style="margin-top:8px">
                                    <select id="eta-vehicle" class="app-select"></select>
                                    <select id="eta-shipment" class="app-select" style="margin-top:6px"></select>
                                    <div style="margin-top:8px" class="app-flex">
                                        <button id="btn-calc-eta" class="app-btn">Estimate ETA</button>
                                        <button id="btn-print" class="app-btn secondary">Print Overview</button>
                                    </div>
                                    <div id="eta-output" style="margin-top:10px" class="app-muted app-small">—</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="page-routes" class="app-card" style="display:none">
                    <h2>Route Planning & Optimization</h2>
                    <div style="display:flex;gap:12px;margin-top:8px">
                        <div style="flex:1">
                            <div class="app-card">
                                <h3>Route Configuration</h3>
                                <label class="app-small">Route Name</label>
                                <input id="route-name" class="app-input" placeholder="Morning Delivery Route">
                                <label class="app-small" style="margin-top:6px">Priority</label>
                                <select id="route-priority" class="app-select">
                                    <option value="high">High Priority</option>
                                    <option value="medium" selected>Medium Priority</option>
                                    <option value="low">Low Priority</option>
                                </select>
                                <label class="app-small" style="margin-top:6px">Max Duration (hours)</label>
                                <input id="route-duration" class="app-input" type="number" placeholder="8" value="8">
                                <div style="margin-top:8px" class="app-flex">
                                    <button id="btn-create-route" class="app-btn">Create Route</button>
                                    <button id="btn-optimize-all-routes" class="app-btn secondary">Optimize All</button>
                                </div>
                            </div>
                            <div class="app-card">
                                <h3>Route Constraints</h3>
                                <div style="margin-top:8px">
                                    <label class="app-flex" style="margin-bottom:8px">
                                        <input type="checkbox" id="avoid-tolls" style="margin-right:8px"> Avoid Toll Roads
                                    </label>
                                    <label class="app-flex" style="margin-bottom:8px">
                                        <input type="checkbox" id="avoid-highways" style="margin-right:8px"> Avoid Highways
                                    </label>
                                    <label class="app-flex" style="margin-bottom:8px">
                                        <input type="checkbox" id="time-windows" style="margin-right:8px"> Respect Time Windows
                                    </label>
                                    <label class="app-flex">
                                        <input type="checkbox" id="vehicle-capacity" checked style="margin-right:8px"> Consider Vehicle Capacity
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div style="flex:1">
                            <div class="app-card">
                                <h3>Active Routes</h3>
                                <div id="routes-list" style="max-height:400px;overflow:auto">
                                    <div class="app-muted app-small">No routes created yet.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="page-analytics" class="app-card" style="display:none">
                    <h2>Advanced Analytics Dashboard</h2>
                    <div class="app-grid-2" style="margin-top:12px">
                        <div>
                            <div class="app-card">
                                <h3>Performance Metrics</h3>
                                <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:8px">
                                    <div style="text-align:center;padding:12px;background:rgba(6,182,212,0.1);border-radius:8px">
                                        <div class="app-small app-muted">Avg Delivery Time</div>
                                        <div id="avg-delivery-time" style="font-size:18px;color:#06b6d4">2.4h</div>
                                    </div>
                                    <div style="text-align:center;padding:12px;background:rgba(124,58,237,0.1);border-radius:8px">
                                        <div class="app-small app-muted">Fuel Efficiency</div>
                                        <div id="fuel-efficiency" style="font-size:18px;color:#7c3aed">15.2 km/L</div>
                                    </div>
                                    <div style="text-align:center;padding:12px;background:rgba(34,197,94,0.1);border-radius:8px">
                                        <div class="app-small app-muted">Success Rate</div>
                                        <div id="success-rate" style="font-size:18px;color:#22c55e">97.8%</div>
                                    </div>
                                    <div style="text-align:center;padding:12px;background:rgba(239,68,68,0.1);border-radius:8px">
                                        <div class="app-small app-muted">Cost per Delivery</div>
                                        <div id="cost-per-delivery" style="font-size:18px;color:#ef4444">₹245</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="app-card">
                                <h3>Delivery Trends (Last 30 Days)</h3>
                                <div id="delivery-chart" style="height:200px;background:rgba(255,255,255,0.02);border-radius:8px;padding:12px;display:flex;align-items:center;justify-content:center">
                                    <div class="app-muted app-small">📊 Delivery trends visualization would appear here</div>
                                </div>
                            </div>

                            <div class="app-card">
                                <h3>Vehicle Utilization</h3>
                                <div id="vehicle-utilization">
                                    <div style="margin-bottom:8px">
                                        <div class="app-flex" style="justify-content:space-between;margin-bottom:4px">
                                            <span class="app-small">TRK-001</span>
                                            <span class="app-small">85%</span>
                                        </div>
                                        <div style="background:rgba(255,255,255,0.1);height:6px;border-radius:3px">
                                            <div style="background:#06b6d4;height:100%;width:85%;border-radius:3px"></div>
                                        </div>
                                    </div>
                                    <div style="margin-bottom:8px">
                                        <div class="app-flex" style="justify-content:space-between;margin-bottom:4px">
                                            <span class="app-small">TRK-002</span>
                                            <span class="app-small">72%</span>
                                        </div>
                                        <div style="background:rgba(255,255,255,0.1);height:6px;border-radius:3px">
                                            <div style="background:#7c3aed;height:100%;width:72%;border-radius:3px"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <div class="app-card">
                                <h3>Geographic Distribution</h3>
                                <div id="geo-map" style="height:300px;background:linear-gradient(180deg,#052032,#07223a);border-radius:8px;padding:8px;display:flex;align-items:center;justify-content:center">
                                    <div class="app-muted app-small">🗺️ Heat map of delivery zones</div>
                                </div>
                            </div>

                            <div class="app-card">
                                <h3>AI Insights</h3>
                                <div id="ai-insights" style="background:rgba(6,182,212,0.05);padding:12px;border-radius:8px;border-left:4px solid #06b6d4">
                                    <div class="app-small" style="color:#06b6d4;margin-bottom:8px">🤖 AI Recommendation</div>
                                    <div class="app-small">Consider adding 1 more vehicle to Zone-North during peak hours (9-11 AM) to reduce delivery delays by 15%.</div>
                                </div>
                                <div style="margin-top:12px;background:rgba(124,58,237,0.05);padding:12px;border-radius:8px;border-left:4px solid #7c3aed">
                                    <div class="app-small" style="color:#7c3aed;margin-bottom:8px">📊 Trend Alert</div>
                                    <div class="app-small">Fuel consumption increased by 8% this week. Route optimization suggested for TRK-003 and TRK-005.</div>
                                </div>
                            </div>

                            <div class="app-card">
                                <h3>Export Analytics</h3>
                                <div class="app-flex" style="gap:8px">
                                    <button id="btn-export-report" class="app-btn">Generate Report</button>
                                    <button id="btn-schedule-report" class="app-btn secondary">Schedule Weekly</button>
                                </div>
                                <div class="app-muted app-small" style="margin-top:8px">Download detailed analytics and performance reports</div>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="page-notifications" class="app-card" style="display:none">
                    <h2>Notification Center</h2>
                    <div style="display:flex;gap:12px;margin-top:8px">
                        <div style="flex:1">
                            <div class="app-card">
                                <div class="app-flex" style="justify-content:space-between;align-items:center;margin-bottom:12px">
                                    <h3>Recent Alerts</h3>
                                    <button id="btn-mark-all-read" class="app-btn secondary app-small">Mark All Read</button>
                                </div>
                                <div id="notifications-list" style="max-height:500px;overflow:auto">
                                    <div style="padding:12px;border-left:4px solid #ef4444;background:rgba(239,68,68,0.05);border-radius:8px;margin-bottom:8px">
                                        <div class="app-flex" style="justify-content:space-between;margin-bottom:4px">
                                            <span style="font-weight:600;color:#ef4444">High Priority Alert</span>
                                            <span class="app-small app-muted">2 mins ago</span>
                                        </div>
                                        <div class="app-small">Vehicle TRK-003 has deviated from assigned route. Current location: 2.3km off track.</div>
                                        <div style="margin-top:8px">
                                            <button class="app-btn app-small">Track Vehicle</button>
                                            <button class="app-btn secondary app-small">Dismiss</button>
                                        </div>
                                    </div>
                                    
                                    <div style="padding:12px;border-left:4px solid #f59e0b;background:rgba(245,158,11,0.05);border-radius:8px;margin-bottom:8px">
                                        <div class="app-flex" style="justify-content:space-between;margin-bottom:4px">
                                            <span style="font-weight:600;color:#f59e0b">Traffic Alert</span>
                                            <span class="app-small app-muted">15 mins ago</span>
                                        </div>
                                        <div class="app-small">Heavy traffic detected on Route A-12. ETA for shipments CN-004, CN-007 increased by 25 minutes.</div>
                                        <div style="margin-top:8px">
                                            <button class="app-btn app-small">Reroute</button>
                                            <button class="app-btn secondary app-small">Notify Customers</button>
                                        </div>
                                    </div>

                                    <div style="padding:12px;border-left:4px solid #22c55e;background:rgba(34,197,94,0.05);border-radius:8px;margin-bottom:8px">
                                        <div class="app-flex" style="justify-content:space-between;margin-bottom:4px">
                                            <span style="font-weight:600;color:#22c55e">Delivery Complete</span>
                                            <span class="app-small app-muted">1 hour ago</span>
                                        </div>
                                        <div class="app-small">Shipment CN-002 delivered successfully to CustomerCorp. Customer rating: 5/5 stars.</div>
                                    </div>

                                    <div style="padding:12px;border-left:4px solid #06b6d4;background:rgba(6,182,212,0.05);border-radius:8px;margin-bottom:8px">
                                        <div class="app-flex" style="justify-content:space-between;margin-bottom:4px">
                                            <span style="font-weight:600;color:#06b6d4">AI Optimization</span>
                                            <span class="app-small app-muted">2 hours ago</span>
                                        </div>
                                        <div class="app-small">Route optimization completed. Total distance reduced by 32km, estimated fuel savings: ₹450.</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div style="flex:1">
                            <div class="app-card">
                                <h3>Notification Settings</h3>
                                <div style="margin-top:12px">
                                    <div style="margin-bottom:16px">
                                        <h4 style="font-size:14px;margin-bottom:8px">Delivery Alerts</h4>
                                        <label class="app-flex" style="margin-bottom:6px">
                                            <input type="checkbox" checked style="margin-right:8px"> Route Deviations
                                        </label>
                                        <label class="app-flex" style="margin-bottom:6px">
                                            <input type="checkbox" checked style="margin-right:8px"> Delivery Delays
                                        </label>
                                        <label class="app-flex" style="margin-bottom:6px">
                                            <input type="checkbox" style="margin-right:8px"> Successful Deliveries
                                        </label>
                                    </div>
                                    
                                    <div style="margin-bottom:16px">
                                        <h4 style="font-size:14px;margin-bottom:8px">Vehicle Alerts</h4>
                                        <label class="app-flex" style="margin-bottom:6px">
                                            <input type="checkbox" checked style="margin-right:8px"> Maintenance Due
                                        </label>
                                        <label class="app-flex" style="margin-bottom:6px">
                                            <input type="checkbox" style="margin-right:8px"> Fuel Low
                                        </label>
                                        <label class="app-flex" style="margin-bottom:6px">
                                            <input type="checkbox" checked style="margin-right:8px"> Emergency Stops
                                        </label>
                                    </div>

                                    <div style="margin-bottom:16px">
                                        <h4 style="font-size:14px;margin-bottom:8px">AI Insights</h4>
                                        <label class="app-flex" style="margin-bottom:6px">
                                            <input type="checkbox" checked style="margin-right:8px"> Optimization Suggestions
                                        </label>
                                        <label class="app-flex" style="margin-bottom:6px">
                                            <input type="checkbox" style="margin-right:8px"> Performance Reports
                                        </label>
                                        <label class="app-flex" style="margin-bottom:6px">
                                            <input type="checkbox" checked style="margin-right:8px"> Traffic Updates
                                        </label>
                                    </div>

                                    <button id="btn-save-settings" class="app-btn" style="width:100%">Save Settings</button>
                                </div>
                            </div>

                            <div class="app-card">
                                <h3>Communication Preferences</h3>
                                <div style="margin-top:12px">
                                    <label class="app-small">Email Notifications</label>
                                    <select class="app-select" style="margin-top:4px">
                                        <option>Immediate</option>
                                        <option selected>Daily Summary</option>
                                        <option>Weekly Summary</option>
                                        <option>Disabled</option>
                                    </select>
                                    
                                    <label class="app-small" style="margin-top:12px;display:block">SMS Alerts</label>
                                    <select class="app-select" style="margin-top:4px">
                                        <option selected>Critical Only</option>
                                        <option>High Priority</option>
                                        <option>All Notifications</option>
                                        <option>Disabled</option>
                                    </select>

                                    <label class="app-small" style="margin-top:12px;display:block">Phone Number</label>
                                    <input class="app-input" placeholder="+91 9548597713" style="margin-top:4px">
                                </div>
                            </div>
                        </div>
                    </div>

                <section id="page-shipments" class="app-card" style="display:none">
                    <h2>Shipments</h2>
                    <div style="display:flex;gap:12px;margin-top:8px">
                        <div style="flex:1">
                            <label class="app-small">Consignment ID</label>
                            <input id="s-id" class="app-input" placeholder="CN-001">
                            <label class="app-small" style="margin-top:6px">Customer</label>
                            <input id="s-customer" class="app-input" placeholder="Name">
                            <label class="app-small" style="margin-top:6px">Address</label>
                            <input id="s-address" class="app-input" placeholder="Address line">
                            <div style="display:flex;gap:8px;margin-top:6px">
                                <input id="s-lat" class="app-input" placeholder="Latitude" style="flex:1">
                                <input id="s-lon" class="app-input" placeholder="Longitude" style="flex:1">
                            </div>
                            <label class="app-small" style="margin-top:6px">Weight (kg)</label>
                            <input id="s-weight" class="app-input" type="number" placeholder="0">
                            <div style="margin-top:8px" class="app-flex">
                                <button id="btn-add-shipment" class="app-btn">Add</button>
                                <button id="btn-clear-shipment" class="app-btn secondary">Clear</button>
                            </div>
                        </div>
                        <div style="flex:1">
                            <h3>Shipment List</h3>
                            <div style="max-height:420px;overflow:auto;margin-top:6px">
                                <table id="tbl-shipments" class="app-table"><thead><tr><th>ID</th><th>Customer</th><th>Lat</th><th>Lon</th><th>Weight</th><th>Assigned</th><th></th></tr></thead><tbody></tbody></table>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="page-vehicles" class="app-card" style="display:none">
                    <h2>Vehicles</h2>
                    <div style="display:flex;gap:12px">
                        <div style="flex:1">
                            <label class="app-small">Vehicle ID</label>
                            <input id="v-id" class="app-input" placeholder="TRK-01">
                            <label class="app-small" style="margin-top:6px">Driver</label>
                            <input id="v-driver" class="app-input" placeholder="Driver name">
                            <label class="app-small" style="margin-top:6px">Current Lat / Lon</label>
                            <div style="display:flex;gap:8px;margin-top:6px">
                                <input id="v-lat" class="app-input" placeholder="Lat" style="flex:1">
                                <input id="v-lon" class="app-input" placeholder="Lon" style="flex:1">
                            </div>
                            <label class="app-small" style="margin-top:6px">Capacity (kg)</label>
                            <input id="v-capacity" class="app-input" type="number" placeholder="1000">
                            <label class="app-small" style="margin-top:6px">Avg speed (km/h)</label>
                            <input id="v-speed" class="app-input" type="number" placeholder="40">
                            <div style="margin-top:8px" class="app-flex">
                                <button id="btn-add-vehicle" class="app-btn">Add Vehicle</button>
                                <button id="btn-clear-vehicle" class="app-btn secondary">Clear</button>
                            </div>
                        </div>
                        <div style="flex:1">
                            <h3>Vehicle Fleet</h3>
                            <div style="max-height:420px;overflow:auto;margin-top:6px">
                                <table id="tbl-vehicles" class="app-table"><thead><tr><th>ID</th><th>Driver</th><th>Cap</th><th>Speed</th><th>Pos</th><th></th></tr></thead><tbody></tbody></table>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="page-ai" class="app-card" style="display:none">
                    <h2>AI Optimizer</h2>
                    <div class="app-muted app-small">Use the built-in optimizer to assign shipments to vehicles. It uses a greedy nearest-neighbor per vehicle and considers capacity.</div>
                    <div style="margin-top:8px" class="app-flex">
                        <button id="btn-run-opt" class="app-btn">Run Optimize</button>
                        <button id="btn-clear-assignments" class="app-btn secondary">Clear Assignments</button>
                        <div style="flex:1" class="app-right app-muted app-small">Assignments stored locally.</div>
                    </div>
                    <div id="opt-result" style="margin-top:12px"></div>
                </section>

                <section id="page-import" class="app-card" style="display:none">
                    <h2>Import / Export</h2>
                    <div class="app-muted app-small">Import or export shipments and vehicles as CSV. This demo does not call external servers.</div>
                    <div style="margin-top:8px">
                        <input id="file-input" class="app-input" type="file" accept="text/csv">
                        <div style="margin-top:8px" class="app-flex">
                            <button id="btn-export-csv" class="app-btn">Export All Data (CSV)</button>
                            <button id="btn-download-json" class="app-btn secondary">Download JSON Backup</button>
                        </div>
                    </div>
                </section>

                <section id="page-chat" class="app-card" style="display:none">
                    <h2>AI Assistant (Rule-based demo)</h2>
                    <div class="app-muted app-small">Type a question like: "Optimize routes", "Assign shipment CN-001 to TRK-01", "ETA for CN-001"</div>
                    <div style="margin-top:8px">
                        <textarea id="chat-input" class="app-textarea" rows="3"></textarea>
                        <div style="margin-top:8px" class="app-flex">
                            <button id="btn-chat-send" class="app-btn">Ask</button>
                            <button id="btn-chat-clear" class="app-btn secondary">Clear</button>
                        </div>
                        <div id="chat-output" style="margin-top:10px;max-height:300px;overflow:auto;background:rgba(255,255,255,0.02);padding:8px;border-radius:8px"></div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <script>
        // Global state management
        let currentView = 'site'; // 'site' or 'demo'
        let currentSection = 'home';
        
        // Demo app state
        const DB_KEY = 'ai_logistics_v1';
        const stateDefault = {shipments:[],vehicles:[],assignments:{}};
        let state = loadState();
        let currentUser = {name:'Guest', role:'viewer'};

        // Navigation functions
        function showSite() {
            currentView = 'site';
            document.getElementById('marketing-site').style.display = 'block';
            document.getElementById('demo-app').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function showDemo() {
            currentView = 'demo';
            document.getElementById('marketing-site').style.display = 'none';
            document.getElementById('demo-app').style.display = 'block';
            document.body.style.overflow = 'auto';
            renderAll();
        }

        function showSection(sectionName) {
            currentSection = sectionName;
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.remove('active');
            });
            
            const targetSection = document.getElementById(sectionName + '-section');
            if (targetSection) {
                targetSection.classList.add('active');
            }
        }

        // Demo app utilities
        function saveState(){
            try {
                localStorage.setItem(DB_KEY,JSON.stringify(state));
                renderAll();
            } catch(e) {
                console.warn('Could not save to localStorage:', e);
            }
        }
        
        function loadState(){
            try{
                const s=localStorage.getItem(DB_KEY);
                return s?JSON.parse(s):structuredClone(stateDefault);
            }catch(e){
                return structuredClone(stateDefault);
            }
        }
        
        function uid(prefix='ID'){return prefix+'-'+Math.random().toString(36).slice(2,9)}
        function hasCoords(item){return item && item.lat!=='' && item.lon!=='' && !isNaN(+item.lat) && !isNaN(+item.lon)}
        function dist(a,b){ 
            const R=6371; 
            const toR=(d)=>d*Math.PI/180;
            const dLat=toR(b.lat-a.lat); 
            const dLon=toR(b.lon-a.lon);
            const A=Math.sin(dLat/2)**2 + Math.cos(toR(a.lat))*Math.cos(toR(b.lat))*Math.sin(dLon/2)**2;
            return R*2*Math.asin(Math.sqrt(A));
        }

        // Render functions
        function renderAll(){
            renderStats();
            renderShipments();
            renderVehicles();
            renderAssignments();
            renderMiniMap();
        }
        
        function renderStats(){
            document.getElementById('stat-shipments').innerText=state.shipments.length;
            document.getElementById('stat-vehicles').innerText=state.vehicles.length;
            const assignedCount=Object.values(state.assignments).flat().length;
            document.getElementById('stat-assigned').innerText=assignedCount;
        }

        function renderShipments(){
            const tbody=document.querySelector('#tbl-shipments tbody');
            tbody.innerHTML='';
            state.shipments.forEach(s=>{
                const tr=document.createElement('tr');
                tr.innerHTML=`<td>${s.id}</td><td>${escapeHtml(s.customer)}</td><td>${s.lat||''}</td><td>${s.lon||''}</td><td>${s.weight||''}</td><td>${isAssigned(s.id)?'<span class="role-badge">Yes</span>':'<span class="app-muted">No</span>'}</td><td><button data-id="${s.id}" class="app-btn secondary btn-assign-inline">Assign</button></td>`;
                tbody.appendChild(tr);
            });
            
            document.querySelectorAll('.btn-assign-inline').forEach(b=>b.addEventListener('click',e=>{
                const id=e.target.dataset.id;
                showAssignModal(id);
            }));
            
            const sel=document.getElementById('eta-shipment');
            sel.innerHTML='';
            const opt=document.createElement('option');
            opt.value='';opt.text='-- Select shipment --';
            sel.appendChild(opt);
            state.shipments.forEach(s=>{
                const o=document.createElement('option');
                o.value=s.id;o.text=`${s.id} — ${s.customer}`;
                sel.appendChild(o);
            });
        }

        function renderVehicles(){
            const tbody=document.querySelector('#tbl-vehicles tbody');
            tbody.innerHTML='';
            state.vehicles.forEach(v=>{
                const tr=document.createElement('tr');
                tr.innerHTML=`<td>${v.id}</td><td>${escapeHtml(v.driver)}</td><td>${v.capacity}</td><td>${v.speed||40}</td><td>${v.lat||''},${v.lon||''}</td><td><button data-id="${v.id}" class="app-btn secondary btn-locate">Locate</button></td>`;
                tbody.appendChild(tr);
            });
            
            document.querySelectorAll('.btn-locate').forEach(b=>b.addEventListener('click',e=>{
                const id=e.target.dataset.id;
                locateVehicle(id);
            }));
            
            const vsel=document.getElementById('eta-vehicle');
            vsel.innerHTML='';
            const vo=document.createElement('option');
            vo.value='';vo.text='-- Select vehicle --';
            vsel.appendChild(vo);
            state.vehicles.forEach(v=>{
                const o=document.createElement('option');
                o.value=v.id;o.text=`${v.id} — ${v.driver}`;
                vsel.appendChild(o);
            });
        }

        function renderAssignments(){
            const cont=document.getElementById('assignments-list');
            cont.innerHTML='';
            const keys=Object.keys(state.assignments);
            if(keys.length===0){
                cont.classList.add('app-muted');
                cont.innerText='No assignments yet.';
                return;
            }
            
            cont.classList.remove('app-muted');
            keys.forEach(k=>{
                const v=state.vehicles.find(x=>x.id===k);
                const ul=document.createElement('div');
                ul.style.marginBottom='8px';
                ul.innerHTML=`<strong>${k} ${v?('- '+escapeHtml(v.driver)):''}</strong>:`;
                const list=document.createElement('div');
                (state.assignments[k]||[]).forEach(sid=>{
                    const s=state.shipments.find(x=>x.id===sid);
                    if(s)list.innerHTML+=`<div class="app-small">${s.id} — ${escapeHtml(s.customer)} (${s.weight}kg)</div>`;
                });
                ul.appendChild(list);
                cont.appendChild(ul);
            });
        }

        function renderMiniMap(){
            const el=document.getElementById('mini-map');
            el.innerHTML='';
            const w=560,h=320;
            const svgNS='http://www.w3.org/2000/svg';
            const svg=document.createElementNS(svgNS,'svg');
            svg.setAttribute('viewBox',`0 0 ${w} ${h}`);
            svg.setAttribute('width','100%');
            svg.setAttribute('height','100%');
            svg.style.borderRadius='8px';
            
            const coords = [...state.shipments.filter(hasCoords),...state.vehicles.filter(hasCoords)];
            let minLat=90,maxLat=-90,minLon=180,maxLon=-180;
            coords.forEach(c=>{
                minLat=Math.min(minLat, +c.lat);
                maxLat=Math.max(maxLat,+c.lat);
                minLon=Math.min(minLon,+c.lon);
                maxLon=Math.max(maxLon,+c.lon);
            });
            
            const pad=0.01; 
            if(coords.length===0){
                const txt=document.createElementNS(svgNS,'text');
                txt.setAttribute('x',w/2);txt.setAttribute('y',h/2);
                txt.setAttribute('fill','#9fbcd6');txt.setAttribute('text-anchor','middle');
                txt.setAttribute('font-size','14');
                txt.textContent='No coordinates provided — enter lat/lon for shipments & vehicles';
                svg.appendChild(txt);
            } else {
                if(minLat===maxLat){minLat-=pad;maxLat+=pad} 
                if(minLon===maxLon){minLon-=pad;maxLon+=pad}
                
                function project(lat,lon){
                    const x=( (lon-minLon)/(maxLon-minLon) )*(w-40)+20; 
                    const y=(1-(lat-minLat)/(maxLat-minLat))*(h-40)+20; 
                    return {x,y};
                }
                
                // Draw grid lines
                for(let i=0;i<5;i++){
                    const line=document.createElementNS(svgNS,'line');
                    line.setAttribute('x1',20);line.setAttribute('x2',w-20);
                    line.setAttribute('y1',20+i*(h-40)/4);line.setAttribute('y2',20+i*(h-40)/4);
                    line.setAttribute('stroke','rgba(255,255,255,0.03)');
                    svg.appendChild(line);
                }
                
                // Draw vehicles
                state.vehicles.filter(hasCoords).forEach(v=>{
                    const p=project(+v.lat,+v.lon);
                    const g=document.createElementNS(svgNS,'g');
                    const circ=document.createElementNS(svgNS,'circle');
                    circ.setAttribute('cx',p.x);circ.setAttribute('cy',p.y);
                    circ.setAttribute('r',8);circ.setAttribute('fill','#06b6d4');
                    g.appendChild(circ);
                    const txt=document.createElementNS(svgNS,'text');
                    txt.setAttribute('x',p.x+12);txt.setAttribute('y',p.y+4);
                    txt.setAttribute('font-size','11');txt.setAttribute('fill','#e2e8f0');
                    txt.textContent=v.id;
                    g.appendChild(txt);
                    svg.appendChild(g);
                });
                
                // Draw shipments
                state.shipments.filter(hasCoords).forEach(s=>{
                    const p=project(+s.lat,+s.lon);
                    const g=document.createElementNS(svgNS,'g');
                    const rect=document.createElementNS(svgNS,'rect');
                    rect.setAttribute('x',p.x-6);rect.setAttribute('y',p.y-6);
                    rect.setAttribute('width',12);rect.setAttribute('height',12);
                    rect.setAttribute('rx',3);rect.setAttribute('fill','#7c3aed');
                    g.appendChild(rect);
                    const txt=document.createElementNS(svgNS,'text');
                    txt.setAttribute('x',p.x+12);txt.setAttribute('y',p.y+4);
                    txt.setAttribute('font-size','11');txt.setAttribute('fill','#e2e8f0');
                    txt.textContent=s.id;
                    g.appendChild(txt);
                    svg.appendChild(g);
                });
                
                // Draw assignment lines
                Object.entries(state.assignments).forEach(([vid,arr])=>{
                    const v=state.vehicles.find(x=>x.id===vid);
                    if(!v||!hasCoords(v))return;
                    let prev={lat:+v.lat,lon:+v.lon};
                    arr.forEach(sid=>{
                        const s=state.shipments.find(x=>x.id===sid);
                        if(!s||!hasCoords(s))return;
                        const p1=project(prev.lat,prev.lon);
                        const p2=project(+s.lat,+s.lon);
                        const line=document.createElementNS(svgNS,'line');
                        line.setAttribute('x1',p1.x);line.setAttribute('y1',p1.y);
                        line.setAttribute('x2',p2.x);line.setAttribute('y2',p2.y);
                        line.setAttribute('stroke','rgba(255,255,255,0.08)');
                        line.setAttribute('stroke-dasharray','4 3');
                        svg.appendChild(line);
                        prev={lat:+s.lat,lon:+s.lon};
                    });
                });
            }
            el.appendChild(svg);
        }

        function escapeHtml(s){
            if(!s) return ''; 
            return String(s).replace(/[&<>"']/g, c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c]));
        }

        function isAssigned(shipmentId){
            return Object.values(state.assignments).some(arr=>arr.includes(shipmentId));
        }

        // CRUD operations
        function canEdit(){
            return (currentUser.role==='admin' || currentUser.role==='dispatcher');
        }

        function showAssignModal(shipmentId){
            if(!canEdit()) return alert('Permission denied: cannot assign shipments in your role.');
            const vid=prompt('Enter vehicle ID to assign shipment '+shipmentId+"\nAvailable vehicles: " + state.vehicles.map(v=>v.id).join(', '));
            if(!vid) return;
            assignShipment(vid.trim(),shipmentId);
        }
        
        function assignShipment(vehicleId,shipmentId){
            if(!state.vehicles.some(v=>v.id===vehicleId)) return alert('Vehicle not found'); 
            if(isAssigned(shipmentId)) return alert('Already assigned'); 
            state.assignments[vehicleId]=state.assignments[vehicleId]||[]; 
            state.assignments[vehicleId].push(shipmentId);
            saveState();
        }

        function locateVehicle(id){
            const v=state.vehicles.find(x=>x.id===id);
            if(!v) return alert('Vehicle not found');
            alert(`Vehicle ${id} — ${v.driver}\nLocation: ${v.lat||'N/A'}, ${v.lon||'N/A'}`);
        }

        function runOptimizer(){
            const unassigned = state.shipments.filter(s=>!isAssigned(s.id)).slice();
            if(unassigned.length===0) return alert('No unassigned shipments');
            const vehiclesWithPos = state.vehicles.filter(v=>hasCoords(v));
            if(vehiclesWithPos.length===0) return alert('No vehicles with coordinates — add vehicle coords');
            
            const result = {}; 
            const vehs = vehiclesWithPos.slice().sort((a,b)=>b.capacity-a.capacity);
            
            vehs.forEach(v=>{
                let remaining = v.capacity; 
                let cur={lat:+v.lat,lon:+v.lon}; 
                result[v.id]=[]; 
                
                while(true){ 
                    let best=null; 
                    let bestD=Infinity; 
                    for(const s of unassigned){ 
                        if(s.weight>remaining) continue; 
                        if(!hasCoords(s)) continue; 
                        const d = dist(cur,{lat:+s.lat,lon:+s.lon}); 
                        if(d<bestD){bestD=d;best=s} 
                    }
                    if(!best) break; 
                    result[v.id].push(best.id); 
                    remaining-=best.weight; 
                    unassigned.splice(unassigned.indexOf(best),1); 
                    cur={lat:+best.lat,lon:+best.lon}; 
                }
            });
            
            // If still unassigned, try assign to any vehicle ignoring coords
            if(unassigned.length>0){
                for(const s of [...unassigned]){
                    for(const v of state.vehicles){
                        const cap=v.capacity - ((state.assignments[v.id]||[]).reduce((a,b)=>{
                            const sh=state.shipments.find(x=>x.id===b);
                            return a + (sh?sh.weight:0);
                        },0) + (result[v.id]? result[v.id].reduce((a,bid)=>{
                            const sh=state.shipments.find(x=>x.id===bid);
                            return a+(sh?sh.weight:0);
                        },0):0)); 
                        if(s.weight<=cap){
                            result[v.id]=result[v.id]||[]; 
                            result[v.id].push(s.id); 
                            unassigned.splice(unassigned.indexOf(s),1); 
                            break;
                        }
                    }
                }
            }
            
            // merge with existing assignments
            Object.entries(result).forEach(([vid,arr])=>{
                state.assignments[vid]=state.assignments[vid]||[]; 
                state.assignments[vid]=state.assignments[vid].concat(arr);
            });
            saveState();
            document.getElementById('opt-result').innerHTML=`<div class="app-muted app-small">Optimizer finished. Assigned ${Object.values(result).flat().length} shipments.</div>`;
        }

        // Initialize demo app event listeners when DOM is loaded
        function initDemoApp() {
            // Add shipment
            document.getElementById('btn-add-shipment').addEventListener('click',()=>{
                if(!canEdit()) return alert('Permission denied: cannot add shipments in your role.');
                const id=document.getElementById('s-id').value.trim()||uid('CN');
                const cust=document.getElementById('s-customer').value.trim()||'Unknown';
                const addr=document.getElementById('s-address').value.trim();
                const lat=document.getElementById('s-lat').value.trim();
                const lon=document.getElementById('s-lon').value.trim();
                const weight=+document.getElementById('s-weight').value||0;
                if(state.shipments.some(s=>s.id===id)) return alert('Shipment ID already exists');
                state.shipments.push({id,customer:cust,address:addr,lat,lon,weight});
                saveState();
                document.getElementById('s-id').value='';
                document.getElementById('s-customer').value='';
                document.getElementById('s-address').value='';
                document.getElementById('s-lat').value='';
                document.getElementById('s-lon').value='';
                document.getElementById('s-weight').value='';
            });

            // Add vehicle
            document.getElementById('btn-add-vehicle').addEventListener('click',()=>{
                if(!canEdit()) return alert('Permission denied: cannot add vehicles in your role.');
                const id=document.getElementById('v-id').value.trim()||uid('V');
                const driver=document.getElementById('v-driver').value.trim()||'Driver';
                const lat=document.getElementById('v-lat').value.trim();
                const lon=document.getElementById('v-lon').value.trim();
                const cap=+document.getElementById('v-capacity').value||1000;
                const sp=+document.getElementById('v-speed').value||40;
                if(state.vehicles.some(v=>v.id===id)) return alert('Vehicle ID exists');
                state.vehicles.push({id,driver,lat,lon,capacity:cap,speed:sp});
                saveState();
                document.getElementById('v-id').value='';
                document.getElementById('v-driver').value='';
                document.getElementById('v-lat').value='';
                document.getElementById('v-lon').value='';
                document.getElementById('v-capacity').value='';
                document.getElementById('v-speed').value='';
            });

            // Clear buttons
            document.getElementById('btn-clear-vehicle').addEventListener('click',()=>{
                document.getElementById('v-id').value='';
                document.getElementById('v-driver').value='';
                document.getElementById('v-lat').value='';
                document.getElementById('v-lon').value='';
                document.getElementById('v-capacity').value='';
                document.getElementById('v-speed').value='';
            });
            
            document.getElementById('btn-clear-shipment').addEventListener('click',()=>{
                document.getElementById('s-id').value='';
                document.getElementById('s-customer').value='';
                document.getElementById('s-address').value='';
                document.getElementById('s-lat').value='';
                document.getElementById('s-lon').value='';
                document.getElementById('s-weight').value='';
            });

            // Reset data
            document.getElementById('btn-reset').addEventListener('click',()=>{
                if(confirm('Reset all app data? This will clear local storage.')){
                    try {
                        localStorage.removeItem(DB_KEY);
                    } catch(e) {}
                    state=structuredClone(stateDefault);
                    saveState();
                }
            });

            // ETA calculation
            document.getElementById('btn-calc-eta').addEventListener('click',()=>{
                const vid=document.getElementById('eta-vehicle').value; 
                const sid=document.getElementById('eta-shipment').value; 
                if(!vid||!sid) return alert('Select both vehicle and shipment'); 
                const v=state.vehicles.find(x=>x.id===vid); 
                const s=state.shipments.find(x=>x.id===sid); 
                if(!v||!s) return alert('Missing data'); 
                if(!hasCoords(v)||!hasCoords(s)) return alert('Both must have lat/lon'); 
                const d=dist({lat:+v.lat,lon:+v.lon},{lat:+s.lat,lon:+s.lon}); 
                const hours=d/(v.speed||40); 
                const etaMin=Math.round(hours*60); 
                document.getElementById('eta-output').innerText=`Distance ≈ ${d.toFixed(2)} km. ETA ≈ ${Math.floor(etaMin/60)}h ${etaMin%60}m (at ${v.speed||40} km/h).`;
            });

            // AI Optimizer
            document.getElementById('btn-run-opt').addEventListener('click',()=>{
                if(!canEdit()) return alert('Permission denied: cannot run optimizer in your role.');
                runOptimizer();
            });
            
            document.getElementById('btn-clear-assignments').addEventListener('click',()=>{
                if(!canEdit()) return alert('Permission denied.'); 
                if(confirm('Clear all assignments?')){
                    state.assignments={};
                    saveState();
                }
            });

            // Quick actions
            document.getElementById('quick-add-shipment').addEventListener('click',()=>{
                document.getElementById('nav-shipments').click();
                document.getElementById('s-id').focus();
            });
            
            document.getElementById('quick-add-vehicle').addEventListener('click',()=>{
                document.getElementById('nav-vehicles').click();
                document.getElementById('v-id').focus();
            });
            
            document.getElementById('quick-optimize').addEventListener('click',()=>{
                document.getElementById('nav-ai').click();
                document.getElementById('btn-run-opt').focus();
            });

            // Export / Import
            document.getElementById('btn-export-csv').addEventListener('click',()=>{
                const rows = [];
                rows.push(['Shipments']); 
                rows.push(['id','customer','address','lat','lon','weight']); 
                state.shipments.forEach(s=>rows.push([s.id,s.customer,s.address,s.lat,s.lon,s.weight])); 
                rows.push([]);
                rows.push(['Vehicles']); 
                rows.push(['id','driver','lat','lon','capacity','speed']); 
                state.vehicles.forEach(v=>rows.push([v.id,v.driver,v.lat,v.lon,v.capacity,v.speed]));
                const csv = rows.map(r=>r.map(c=>`"${String(c||'').replace(/"/g,'""')}"`).join(',')).join('\n'); 
                const blob=new Blob([csv],{type:'text/csv'}); 
                const url=URL.createObjectURL(blob); 
                const a=document.createElement('a'); 
                a.href=url; 
                a.download='ai_logistics_export.csv'; 
                a.click(); 
                URL.revokeObjectURL(url);
            });
            
            document.getElementById('btn-download-json').addEventListener('click',()=>{
                const blob=new Blob([JSON.stringify(state,null,2)],{type:'application/json'}); 
                const url=URL.createObjectURL(blob); 
                const a=document.createElement('a'); 
                a.href=url; 
                a.download='ai_logistics_backup.json'; 
                a.click(); 
                URL.revokeObjectURL(url);
            });
            
            document.getElementById('file-input').addEventListener('change',e=>{
                const f=e.target.files[0]; 
                if(!f) return; 
                const reader=new FileReader(); 
                reader.onload=ev=>{
                    const txt=ev.target.result; 
                    if(txt.includes('\n\nShipments')||txt.includes('\nShipments')){ 
                        const parts=txt.split('\n\n'); 
                        let sPart=parts.find(p=>p.includes('Shipments'))||''; 
                        let vPart=parts.find(p=>p.includes('Vehicles'))||''; 
                        if(sPart){
                            const lines=sPart.split('\n').slice(2); 
                            for(const line of lines){
                                if(!line.trim()) continue; 
                                const cols=csvSplit(line); 
                                state.shipments.push({id:cols[0],customer:cols[1],address:cols[2],lat:cols[3],lon:cols[4],weight:+cols[5]||0});
                            }
                        } 
                        if(vPart){
                            const vlines=vPart.split('\n').slice(2); 
                            for(const line of vlines){
                                if(!line.trim()) continue; 
                                const cols=csvSplit(line); 
                                state.vehicles.push({id:cols[0],driver:cols[1],lat:cols[2],lon:cols[3],capacity:+cols[4]||1000,speed:+cols[5]||40});
                            }
                        } 
                        saveState(); 
                        alert('Import complete');
                    } else {
                        alert('CSV format not recognized — use export from this app for best results.');
                    }
                }; 
                reader.readAsText(f);
            });

            // Chatbot
            document.getElementById('btn-chat-send').addEventListener('click',()=>{
                const q=document.getElementById('chat-input').value.trim();
                if(!q) return;
                const out=document.getElementById('chat-output');
                appendChat('You',q);
                const resp=chatbotRespond(q);
                appendChat('AI',resp);
                document.getElementById('chat-input').value='';
            });
            
            document.getElementById('btn-chat-clear').addEventListener('click',()=>{
                document.getElementById('chat-output').innerHTML='';
            });

            // Login
            document.getElementById('btn-login').addEventListener('click',()=>{
                const name=document.getElementById('login-name').value.trim()||'Guest';
                const role=document.getElementById('login-role').value;
                currentUser={name,role};
                document.getElementById('ui-username').innerText=name;
                document.getElementById('ui-role').innerText=role;
                document.getElementById('ui-role').className='role-badge';
                applyRole();
            });

            // Print
            document.getElementById('btn-print').addEventListener('click',()=>{
                window.print();
            });

            // Navigation
            document.querySelectorAll('.app-nav button').forEach(b=>b.addEventListener('click',e=>{
                document.querySelectorAll('.app-nav button').forEach(x=>x.classList.remove('active')); 
                e.target.classList.add('active'); 
                const id='page-'+e.target.id.replace('nav-',''); 
                document.querySelectorAll('.app-content section').forEach(s=>s.style.display=s.id===id?'block':'none');
            }));
        }

        function csvSplit(line){
            const out=[]; 
            let cur=''; 
            let inq=false; 
            for(let i=0;i<line.length;i++){
                const c=line[i]; 
                if(c==='"'){inq=!inq; continue} 
                if(c===',' && !inq){out.push(cur);cur='';continue;} 
                cur+=c;
            } 
            out.push(cur); 
            return out.map(s=>s.replace(/""/g,'"').replace(/^"|"$/g,''));
        }

        function appendChat(who,msg){
            const d=document.createElement('div');
            d.className='app-small';
            d.innerHTML=`<strong>${who}:</strong> ${escapeHtml(msg)}`;
            document.getElementById('chat-output').appendChild(d);
            document.getElementById('chat-output').scrollTop=1e9;
        }
        
        function chatbotRespond(q){
            q=q.toLowerCase(); 
            if(q.includes('optimi')){
                runOptimizer(); 
                return 'Running optimizer and saved assignments. Check AI Optimizer tab.'
            } 
            if(q.includes('assign')){
                const m=q.match(/assign\s+([\w-]+)\s+to\s+([\w-]+)/); 
                if(m){
                    const sid=m[1].toUpperCase(); 
                    const vid=m[2].toUpperCase(); 
                    if(!state.shipments.some(s=>s.id===sid)) return 'Shipment not found: '+sid; 
                    if(!state.vehicles.some(v=>v.id===vid)) return 'Vehicle not found: '+vid; 
                    assignShipment(vid,sid); 
                    return `Assigned ${sid} to ${vid}`;
                } 
                return 'To assign use: Assign CN-001 to V-01'; 
            } 
            if(q.includes('eta')){
                const m=q.match(/([A-Za-z0-9-]+)/); 
                if(m){
                    const sid=m[1].toUpperCase(); 
                    const s=state.shipments.find(x=>x.id===sid); 
                    const v=state.vehicles[0]; 
                    if(!s||!v) return 'Provide shipment id like CN-001 and ensure at least one vehicle exists'; 
                    if(!hasCoords(s)||!hasCoords(v)) return 'Missing coordinates for ETA calculation'; 
                    const d=dist({lat:+v.lat,lon:+v.lon},{lat:+s.lat,lon:+s.lon}); 
                    const etaMin=Math.round((d/(v.speed||40))*60); 
                    return `ETA ≈ ${Math.floor(etaMin/60)}h ${etaMin%60}m from ${v.id}`;
                } 
                return 'Try: ETA for CN-001'; 
            } 
            if(q.includes('help')||q.includes('how')) return 'Use: "Optimize routes", "Assign CN-001 to V-01", "ETA for CN-001". You can also import CSV or add data via forms.'; 
            return 'Sorry I did not understand. Try: Optimize routes / Assign CN-001 to V-01 / ETA for CN-001'; 
        }

        function applyRole(){ 
            const r=currentUser.role; 
            const editable = (r==='admin' || r==='dispatcher'); 
            document.querySelectorAll('#btn-add-shipment,#btn-add-vehicle,#btn-run-opt,#btn-clear-assignments,#btn-export-csv,#btn-download-json').forEach(el=>el.disabled=!editable); 
            document.getElementById('login-role').value=currentUser.role;
        }

        // Marketing site functions
        function init3DBackground() {
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            
            const heroContainer = document.getElementById('hero-bg');
            if (!heroContainer) return;
            
            renderer.setSize(heroContainer.offsetWidth, heroContainer.offsetHeight);
            renderer.setClearColor(0x000000, 0);
            heroContainer.appendChild(renderer.domElement);

            // Create particles
            const particleCount = 150;
            const particles = new THREE.BufferGeometry();
            const positions = new Float32Array(particleCount * 3);
            const colors = new Float32Array(particleCount * 3);

            for (let i = 0; i < particleCount * 3; i += 3) {
                positions[i] = (Math.random() - 0.5) * 100;
                positions[i + 1] = (Math.random() - 0.5) * 100;
                positions[i + 2] = (Math.random() - 0.5) * 100;

                colors[i] = Math.random() * 0.5 + 0.5;
                colors[i + 1] = Math.random() * 0.3 + 0.7;
                colors[i + 2] = 1;
            }

            particles.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            particles.setAttribute('color', new THREE.BufferAttribute(colors, 3));

            const particleMaterial = new THREE.PointsMaterial({
                size: 0.5,
                vertexColors: true,
                transparent: true,
                opacity: 0.6
            });

            const particleSystem = new THREE.Points(particles, particleMaterial);
            scene.add(particleSystem);

            // Create connecting lines
            const lineGeometry = new THREE.BufferGeometry();
            const linePositions = [];
            const lineColors = [];

            for (let i = 0; i < particleCount; i++) {
                for (let j = i + 1; j < particleCount; j++) {
                    const dx = positions[i * 3] - positions[j * 3];
                    const dy = positions[i * 3 + 1] - positions[j * 3 + 1];
                    const dz = positions[i * 3 + 2] - positions[j * 3 + 2];
                    const distance = Math.sqrt(dx * dx + dy * dy + dz * dz);

                    if (distance < 20) {
                        linePositions.push(positions[i * 3], positions[i * 3 + 1], positions[i * 3 + 2]);
                        linePositions.push(positions[j * 3], positions[j * 3 + 1], positions[j * 3 + 2]);
                        
                        const alpha = 1 - distance / 20;
                        lineColors.push(0.4, 0.6, 1, alpha);
                        lineColors.push(0.4, 0.6, 1, alpha);
                    }
                }
            }

            lineGeometry.setAttribute('position', new THREE.Float32BufferAttribute(linePositions, 3));
            lineGeometry.setAttribute('color', new THREE.Float32BufferAttribute(lineColors, 4));

            const lineMaterial = new THREE.LineBasicMaterial({
                vertexColors: true,
                transparent: true,
                opacity: 0.3
            });

            const lines = new THREE.LineSegments(lineGeometry, lineMaterial);
            scene.add(lines);

            camera.position.z = 50;

            function animate() {
                requestAnimationFrame(animate);
                
                particleSystem.rotation.x += 0.001;
                particleSystem.rotation.y += 0.002;
                lines.rotation.x += 0.001;
                lines.rotation.y += 0.002;

                renderer.render(scene, camera);
            }

            animate();

            // Handle resize
            window.addEventListener('resize', () => {
                if (heroContainer.offsetWidth && heroContainer.offsetHeight) {
                    camera.aspect = heroContainer.offsetWidth / heroContainer.offsetHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(heroContainer.offsetWidth, heroContainer.offsetHeight);
                }
            });
        }

        // Initialize everything
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize demo app
            initDemoApp();
            
            // Initialize 3D background
            init3DBackground();
            
            // Navbar scroll effect
            window.addEventListener('scroll', () => {
                const navbar = document.getElementById('navbar');
                if (navbar && window.scrollY > 100) {
                    navbar.classList.add('scrolled');
                } else if (navbar) {
                    navbar.classList.remove('scrolled');
                }
            });

            // Initialize demo state
            renderAll();
            applyRole();
        });

        // Expose debug functions
        window.__AI_LOG = {state,saveState,runOptimizer,assignShipment,dist,showDemo,showSite};
    </script>
</body>
</html>small">Shipments</div>
                                        <div id="stat-shipments" style="font-size:18px">0</div>
                                    </div>
                                    <div style="flex:1">
                                        <div class="app-muted app-small">Vehicles</div>
                                        <div id="stat-vehicles" style="font-size:18px">0</div>
                                    </div>
                                    <div style="flex:1">
                                        <div class="app-muted app-